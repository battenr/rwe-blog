{
  "hash": "a480d47ee988446d86bb7f788a93d41f",
  "result": {
    "markdown": "---\ntitle: \"Mastering Statistics Through Make-Believe\" \nsubtitle: \"Simulated Data in R\"\nauthor: \"Ryan Batten\"\ndate: \"2023-09-02\"\ncategories: [Simulating Data]\nbibliography: sim_data.bib\n# image : \"standards.png\"\ndraft: true\nformat: \n  html:\n    toc: true\n    toc-title: Contents\n    toc-location: right\n    toc-depth: 4\n    code-fold: true\n---\n\n\n## Simulating Data, Why?\n\nSimulating data wasn't something that I was taught in school. I've learned it since graduating/during my PhD, in my pursuit of improving my stats knowledge (the more I learn the more I feel I don't know, weird feeling). It's been unbelievably useful.\n\nI wanted to write this post to help anyone else who isn't familiar with simulating data. Before, I just want to give a few use cases where I've found simulating data helpful:\n\n-   Showing bias (confounder, collider, etc)\n\n-   Understanding how methods work\n\n-   Comparing different methods (1:1 matching vs IPTW, etc)\n\n-   Understand data generating mechanisms\n\n::: callout-note\n## Stats for non-stats\n\nI'm a tradesman biostatistician \\[NOTE: RYAN CHECK THIS TERM FROM HIS TWEET\\] (credit to PhDemetri for this term). Basically, I've done a few statistics courses but don't have a degree in it (I do in clinical epidemiology which overlaps substantially with biostatistics).\n\nIf you do, hopefully this is a good refresher. If you don't, don't worry! I don't either so hopefully this helps out a little as an intro.\n:::\n\n## Basics\n\nBefore we dive into some R code, which I do love, it's useful to first understand at a high level how this works. Before you scramble to close this, wait! I promise it isn't going to be technical or boring. Alright, let's get started.\n\n## Showing Confounding\n\nLet's assume that we want to test how not adjusting for a confounder can lead to confounding bias. For this situation let's look at hot coffee and rainbows. We can draw a DAG, including our confounder which is weather.\n\nFor this, our question is \"does hot coffee cause rainbows?\". Rainy days lead to drinking more coffee, but rainy days also lead to rainbows. \\\n\\\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n\n```{.r .cell-code}\nlibrary(ggdag)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'ggdag'\n\nThe following object is masked from 'package:stats':\n\n    filter\n```\n:::\n\n```{.r .cell-code}\ntheme_set(theme_dag())\n\ndag = ggdag::dagify(\n  hot_coffee ~ rain, \n  rainbow ~ rain + hot_coffee, \n  exposure = \"hot_coffee\",\n  outcome = \"rainbow\",\n  labels = c(\n    hot_coffee = \"Hot\\nCoffee\",\n    rainbow = \"Rainbow\", \n    rain = \"Rain\"\n  )\n) \n\ndag %>% \n  ggdag::ggdag(layout = \"tree\", \n               text = FALSE,\n               use_labels = \"label\")\n```\n\n::: {.cell-output-display}\n![](sim_data_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n\ng at how long goldfish grow as an example. There's a few factors that affect the size (in this example length and size will be used interchangeably): feeding_frequency (number of times per day), water temperate, and how much food.\n\n\\# Simulate data for 100 goldfish\n\nset.seed(123)\n\nn \\<- 100\n\n\\# Nutritional factors\n\nfood_quality \\<- rnorm(n, mean = 5, sd = 1)\n\nfeeding_frequency \\<- rnorm(n, mean = 3, sd = 0.5)\n\n\\# Environmental factors\n\nwater_quality \\<- rnorm(n, mean = 7, sd = 1)\n\nwater_temp \\<- rnorm(n, mean = 20, sd = 2)\n\n\\# Growth rate as the dependent variable\n\ngrowth_rate \\<- 0.5 + 0.2\\*food_quality + 0.1\\*feeding_frequency + 0.3\\*water_quality + 0.4\\*water_temp + rnorm(n, mean = 0, sd = 0.5)\n\n\\# Combine into a data frame\n\ngoldfish_data \\<- data.frame(food_quality, feeding_frequency, water_quality, water_temp, growth_rate)\n\nLet's use how long goldfish grow as an example. For ease of this example, let's\n\n### \n\nThis type of simulation is called a Monte Carlo Simulation. The reason it's so useful is because\n\nof coffee beans. These range in shape and size. Suppose we know that the average weight is 135 milligrams and 16 (10 to 22/64 of an inch). Now, does this mean that every bean will be that? Let's pull one out and see\n\n## Simulating Data\n\nWe'll start with continuous data. To simulate this we need two pieces of information, also known as parameters: mean and standard deviation.\n\n::: callout-note\n## TTE Outcome\n\nThis post will focus on continuous and binary outcomes. A future blog post will go over how to simulate time-to-event, sometimes called survival, data.\n:::\n\nNOTE TO SELF: explain that regression is finding the mean (keith mcnulty's post)\n\nNow, if we pick one\n\n# Old Text\n\nLearning to simulate data was one of the best things that I've stumbled into. It can help improve your knowledge of statistics and inform decision making. One of the things I found difficult when starting was for a resource that gave some examples of what I really wanted to know. Hopefully this post will provide a decent start to someone.\n\n## Why Simulate?\n\nAt first, I had heard about simulation studies but wasn't exactly sure the purpose of them.\n\n## Steps to Simulate\n\n\\@morris2019 use the acronym ADEMP: Aims, Data-generating mechanisms, Methods, Estimands and Performance measures. This is a great acronym which we'l'' break down a little bit .\n\n## Over and Over and Over Again\n\nNow we've simulated data. Great! But how can we trust this? We only did it once. What if the sample of the same size (N = X \\[RYAN: INSERT NUMBER\\]) gave a different answer? To account for this, we need to repeat this multiple times. So, let's do that!\n\n::: callout-note\n## Selecting n for Monte Carlo simulation\n\nTo select the n required, there are several resources. I won't go into detail here, but some personal references I use are \\[INSERT Morris et al. and others\\]\n:::\n\nMonte Carlo simulation is\n\n## Resources for Simulating\n\nThere are a ton of good resources when it comes to design aspects of simulation study. Two that help me think about simulation studies are \\@morris2019 and \\@burton2006.\n\n## Why simulate data?\n\n## Tips for generating data\n\n(RYAN ADD REF THAT TALKS ABOUT SIMULATING DATA)\n",
    "supporting": [
      "sim_data_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}