{
  "hash": "eee59769ec26a57fbbce141ad6770754",
  "result": {
    "markdown": "---\ntitle: \"Causal Estimands\" \nsubtitle: \"Who does this apply too?\"\nauthor: \"Ryan Batten\"\ndate: \"2023-06-22\"\ncategories: [Estimands, ATE, ATT, ATU]\n# image : \"standards.png\"\nbibliography: estimands.bib\ndraft: true\nformat: \n  html:\n    toc: true\n    toc-title: Contents\n    toc-location: right\n    toc-depth: 4\n    code-fold: true\n---\n\n\n## Who does this apply too?\n\nA key part of any research question is to determine who this applies too. There are several different ways to determine this but this post will focus on the causal estimand. Specifically, who does this result apply to? It's even more important when we have secondary data where patients aren't randomized to a treatment/group. Let's start with an example\\\n\n## Example\n\nAs per usual, time for an example! Say that we have a magical water gun that makes you grow taller. Before we do any analyses we need to setup our research question. In clinical epidemiology this is typically PICO(S): population, intervention, comparators, outcome and sometimes study design. The causal estimand helps us with the first letter: P by asking \"who does this apply too?\". Now the who refers to the target population, that is the people we are...well targeting (not necessarily those we sample and study).\n\nFor our study, we have two groups: monsters and kids. We want to figure out who the magically water gun will work on. Why? Well both monsters and kids are pretty short, their friends want to know if they will grow!\n\n![Kids and Monsters](kids_monsters.png)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n\nn.monsters = 135\nn.kids = 452\n\nset.seed(135451)\n\nmonsters <- data.frame(\n  eyes = runif(n.monsters, min = 1, max = 5),\n  age = rnorm(n.monsters, mean = 200, sd = 50),\n  group = \"monsters\"\n) %>% \n  dplyr::mutate(\n  height = eyes*0.5 + age/1000,\n  sprayed = rbinom(n.monsters, size = 1, prob = plogis(0.01*age + 0.2*eyes))\n  )\n\nkids <- data.frame(\n  eyes = 2,\n  age = rnorm(n.kids, mean = 5, sd = 2),\n  group = \"kids\"\n) %>% \n  dplyr::mutate(\n  height = eyes*0.5 + age/10,\n  sprayed = rbinom(n.kids, size = 1, prob = plogis(0.2*age + 0.125*eyes))\n  )\n\ndf <- rbind(\n  monsters, \n  kids\n)\n```\n:::\n\n\n|                             | Monsters (n = 135) | Kids ( n = 452)  |\n|:---------------------------:|:------------------:|:----------------:|\n|  Number of eyes, mean (SD)  |    2.99 (1.22)     |      2 (0)       |\n|       Age, mean (SD)        |   206.90 (45.78)   |   5.16 (1.92)    |\n| Sprayed by water gun, n (%) |    123 (91.1%)     |   328 (72.6%)    |\n| Height (in feet), mean (SD) |    1.70 (0.61)     |   1.51 (0.19)    |\n\n: **Characteristics of Monsters and Kids**\n\n## Types of Estimands\n\nWe'll focus on four causal estimands, in no particular order:\n\n-   Average treatment effect in the population (ATE)\n\n-   Average treatment effect in the treated (ATT)\n\n-   Average treatment effect in the untreated (ATU)\n\n-   Average treatment effect in the overlap (ATO)\n\nOne important thing to note here is that all of these estimands would be the same in a randomized trial because the characteristics will be the same (at least in theory) Therefore the ATT, ATU and ATE will be the same. However, not so in observational data.\n\n## Potential Outcomes\n\n::: callout-note\nAn important part here is the potential outcomes framework. The potential outcomes can be written as $Y_0$ and $Y_i$. For a binary treatment, like in our case, we can think of it as each person has two potential outcomes (one if they get sprayed by the water gun, one if not). Depending on what happens, one of the outcomes is observed. \\\n\\\nNow, the individual causal effect is $Y_1$ - $Y_0$ for each person. We can't know this for each person, so instead we take an average (if we assume certain things). In math terms, we show this as $E[Y_{1} - Y_{0}]$.\n:::\n\n### ATE\n\nThe ATE is the the average treatment effect among all eligible patients in the study population (i.e., difference were they all to be treated vs were they all not to be treated) [@greifer2021choosing]. For our example, it would be the difference were all the monsters and kids sprayed with the water gun versus were the monster and kids not sprayed.\n\nTo estimate the ATE, we can use inverse probability weights.\n\nThe ATE asks \"What would happen on average to all kids if every kid got sprayed with the Magic Growth Water, compared to if no kid got sprayed at all?\" Essentially, it's the difference in average height between a world where everyone gets sprayed and a world where no one gets sprayed.\n\nIn IPTW terms, both patients are reweighted. We can do that using\n\n### ATT\n\nIn IPTW terms, those that received treatment receive a weight of 1.0 and those that received control they\n\nHere, we're focusing on the kids who chose to get sprayed. So we ask, \"What is the average effect on those kids who actually got sprayed with the Magic Growth Water?\" That is, among kids who are already getting sprayed, how much taller are they on average because of the Magic Growth Water?\n\n### ATU\n\nIn IPTW terms, those that received placebo (control) receive a weight of 1.0 and those that were treated are weighted.\n\nThis is the opposite of ATT. It's like asking, \"What would be the average effect on those kids who didn't get sprayed if they started getting sprayed?\" So, among kids who don't currently get sprayed, how much taller would they be on average if they started getting sprayed?\n\n### ATO\n\nATO is the average treatment in the overalp.\n\n## Adjustment Techniques\n\nPicking the estimand of interest isn't just important for the target population but also for the adjustment technique selected. Certain ones can only target certain estimands. This becomes even more important when you are comparing methods. For example, IPW and PSM do not target the same estimand [@greifer2021choosing].\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}